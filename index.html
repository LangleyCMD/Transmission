<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LANGLEY CALLING</title>

<style>
body {
  background-color: #000;
  color: #00ff66;
  font-family: 'Courier New', monospace;
  padding: 2rem;
  font-size: 1.2rem;
  line-height: 1.5;
}

.glitch {
  position: relative;
  display: inline-block;
  animation: flicker 2s infinite;
}

@keyframes flicker {
  0%,100%{opacity:1}
  50%{opacity:.4}
}

.typewriter {
  white-space: pre-wrap;
  border-right: .1em solid #00ff66;
}

#input-line { margin-top:1rem; }

#commandInput {
  background:black;
  color:#00ff66;
  border:none;
  outline:none;
  font-family:inherit;
  font-size:1.2rem;
  width:80%;
}

/* ==== GRID LOCK ==== */

#grid-lock {
  margin-top:40px;
}

.grid {
  display:grid;
  grid-template-columns:repeat(3,70px);
  gap:8px;
}

.cell {
  width:70px;
  height:70px;
  border:2px solid #00ff66;
  cursor:pointer;
  transition:.2s;
}

.cell:hover {
  background:#003311;
}

.cell.active {
  background:#00ff66;
}

.cell.error {
  background:#330000;
}
</style>
</head>

<body>

<div class="glitch">&gt; SYSTEM: ONLINE...</div>
<br><br>

<pre id="output" class="typewriter"></pre>

<div id="input-line">
<span id="prompt"></span>
<input id="commandInput" autocomplete="off">
</div>

<!-- ==== GRID LOCK ==== -->

<div id="grid-lock">
<p>>> AUTORYZACJA WZORCEM</p>
<div class="grid">
<div class="cell" data-id="0"></div>
<div class="cell" data-id="1"></div>
<div class="cell" data-id="2"></div>
<div class="cell" data-id="3"></div>
<div class="cell" data-id="4"></div>
<div class="cell" data-id="5"></div>
<div class="cell" data-id="6"></div>
<div class="cell" data-id="7"></div>
<div class="cell" data-id="8"></div>
</div>
</div>

<script>

/* ==== TERMINAL — skrócona wersja ==== */

const PASSWORD='X7f9P2z';
let secureUnlocked=false;
let awaitingPassword=false;

const output=document.getElementById("output");
const input=document.getElementById("commandInput");
const prompt=document.getElementById("prompt");

let currentPath="/";

function updatePrompt(){
prompt.textContent=currentPath+"> ";
}

function print(t){
output.textContent+=`\n${t}`;
window.scrollTo(0,document.body.scrollHeight);
}

updatePrompt();

input.addEventListener("keydown",e=>{
if(e.key!=="Enter")return;

let cmd=input.value.trim();
input.value="";

if(awaitingPassword){
if(cmd===PASSWORD){
secureUnlocked=true;
print("DOSTĘP PRZYZNANY");
}else print("BŁĘDNE HASŁO");
awaitingPassword=false;
return;
}

if(cmd==="cd secure"){
if(!secureUnlocked){
awaitingPassword=true;
print("Podaj hasło:");
return;
}
currentPath="/secure";
updatePrompt();
}

else if(cmd==="help"){
print("help\ncd secure");
}

else print("Nieznane polecenie");

});

/* ==== GRID LOCK ==== */

const secretPattern=[0,4,8];
let userPattern=[];

document.querySelectorAll(".cell").forEach(cell=>{
cell.addEventListener("click",()=>{
const id=parseInt(cell.dataset.id);

cell.classList.add("active");
userPattern.push(id);

checkPattern();
});
});

function checkPattern(){

let step=userPattern.length-1;

if(userPattern[step]!==secretPattern[step]){
flashError();
resetPattern();
return;
}

if(userPattern.length===secretPattern.length){
unlockSecure();
resetPattern();
}
}

function unlockSecure(){

secureUnlocked=true;

print(">>> WZORZEC POPRAWNY");
print(">>> /secure ODBLOKOWANY");
}

function resetPattern(){
setTimeout(()=>{
document.querySelectorAll(".cell")
.forEach(c=>c.classList.remove("active","error"));
userPattern=[];
},600);
}

function flashError(){
document.querySelectorAll(".cell")
.forEach(c=>c.classList.add("error"));
}

</script>

</body>
</html>
